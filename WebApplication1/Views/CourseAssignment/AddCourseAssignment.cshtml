@model AMS.Models.ViewModels.AddCourseAssignmentViewModel
@{
    ViewData["Title"] = "Assign Course";
}

<!-- Page Header -->
<div class="mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between">
    <h2 class="text-title-md2 font-bold text-gray-900 dark:text-white">
        Assign Course
    </h2>
    <nav>
        <ol class="flex items-center gap-2">
            <li>
                <a asp-controller="Home" asp-action="Index" class="text-sm font-medium text-gray-500 hover:text-brand-500 dark:text-gray-400">Home</a>
            </li>
            <li class="text-sm font-medium text-gray-500 dark:text-gray-400">/</li>
            <li>
                <a asp-controller="CourseAssignment" asp-action="CourseAssignments" class="text-sm font-medium text-gray-500 hover:text-brand-500 dark:text-gray-400">Course Assignments</a>
            </li>
            <li class="text-sm font-medium text-gray-500 dark:text-gray-400">/</li>
            <li class="text-sm font-medium text-brand-500">Assign Course</li>
        </ol>
    </nav>
</div>

<!-- Form Card -->
<div class="rounded-lg border border-gray-200 bg-white shadow-sm dark:border-gray-800 dark:bg-gray-900">
    <div class="border-b border-gray-200 px-6 py-4 dark:border-gray-800">
        <h3 class="text-lg font-semibold text-gray-900 dark:text-white">Course Assignment Form</h3>
        <p class="mt-1 text-sm text-gray-500 dark:text-gray-400">Assign a course to a teacher for a specific batch and semester</p>
    </div>

    <form asp-action="AddCourseAssignment" method="post" class="p-6">
        @Html.AntiForgeryToken()

        <div asp-validation-summary="All" class="mb-6 rounded-xl border border-error-500 bg-error-50 p-4 dark:border-error-500/30 dark:bg-error-500/15 hidden"></div>

        <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
            <!-- Teacher -->
            <div>
                <label asp-for="TeacherId" class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-400">
                    Teacher <span class="text-error-500">*</span>
                </label>
                <select asp-for="TeacherId"
                        asp-items="Model.Teachers"
                        class="h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-sm focus:border-brand-500 focus:outline-none focus:ring-2 focus:ring-brand-500/20 dark:border-gray-700 dark:bg-gray-900 dark:text-white">
                    <option value="">Select a teacher</option>
                </select>
                <span asp-validation-for="TeacherId" class="mt-1 text-xs text-error-500"></span>
            </div>

            <!-- Course -->
            <div>
                <label asp-for="CourseId" class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-400">
                    Course <span class="text-error-500">*</span>
                </label>
                <select asp-for="CourseId"
                        asp-items="Model.Courses"
                        class="h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-sm focus:border-brand-500 focus:outline-none focus:ring-2 focus:ring-brand-500/20 dark:border-gray-700 dark:bg-gray-900 dark:text-white">
                    <option value="">Select a course</option>
                </select>
                <span asp-validation-for="CourseId" class="mt-1 text-xs text-error-500"></span>
            </div>

            <!-- Batch -->
            <div>
                <label asp-for="BatchId" class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-400">
                    Batch <span class="text-error-500">*</span>
                </label>
                <select asp-for="BatchId"
                        asp-items="Model.Batches"
                        class="h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-sm focus:border-brand-500 focus:outline-none focus:ring-2 focus:ring-brand-500/20 dark:border-gray-700 dark:bg-gray-900 dark:text-white">
                    <option value="">Select a batch</option>
                </select>
                <span asp-validation-for="BatchId" class="mt-1 text-xs text-error-500"></span>
            </div>

            <!-- Semester -->
            <div>
                <label asp-for="SemesterId" class="mb-2 block text-sm font-medium text-gray-700 dark:text-gray-400">
                    Semester <span class="text-error-500">*</span>
                </label>
                <select asp-for="SemesterId"
                        asp-items="Model.Semesters"
                        class="h-11 w-full rounded-lg border border-gray-300 bg-transparent px-4 py-2.5 text-sm text-gray-800 shadow-sm focus:border-brand-500 focus:outline-none focus:ring-2 focus:ring-brand-500/20 dark:border-gray-700 dark:bg-gray-900 dark:text-white">
                    <option value="">Select a semester</option>
                </select>
                <span asp-validation-for="SemesterId" class="mt-1 text-xs text-error-500"></span>
            </div>

            <!-- Status -->
            <div class="sm:col-span-2">
                <div class="flex items-center gap-3">
                    <input asp-for="IsActive"
                           type="checkbox"
                           class="h-5 w-5 rounded border-gray-300 text-brand-500 focus:ring-2 focus:ring-brand-500/20 dark:border-gray-700 dark:bg-gray-900" />
                    <label asp-for="IsActive" class="text-sm font-medium text-gray-700 dark:text-gray-400">
                        Active Assignment
                    </label>
                </div>
                <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">
                    Check this to make the assignment active. Inactive assignments won't appear in active course lists.
                </p>
            </div>
        </div>

        <!-- Form Actions -->
        <div class="mt-6 flex items-center justify-end gap-3 border-t border-gray-200 pt-6 dark:border-gray-800">
            <a asp-action="CourseAssignments"
               class="inline-flex items-center justify-center rounded-lg border border-gray-300 bg-white px-5 py-2.5 text-sm font-medium text-gray-700 transition-colors hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-400/50 dark:border-gray-700 dark:bg-gray-900 dark:text-gray-300 dark:hover:bg-gray-800">
                <svg class="mr-2 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
                Cancel
            </a>
            <button type="submit"
                    class="inline-flex items-center justify-center rounded-lg bg-indigo-600 px-5 py-2.5 text-sm font-medium text-white transition-colors hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500/50">
                <svg class="mr-2 h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                </svg>
                Assign Course
            </button>
        </div>
    </form>
</div>

<!-- Info Card -->
<div class="mt-6 rounded-lg border border-blue-200 bg-blue-50 p-4 dark:border-blue-500/30 dark:bg-blue-500/10">
    <div class="flex items-start gap-3">
        <div class="-mt-0.5 text-blue-500">
            <svg class="fill-current" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" clip-rule="evenodd" d="M12 3.70186C7.41711 3.70186 3.70186 7.41711 3.70186 12C3.70186 16.5829 7.41711 20.2981 12 20.2981C16.5829 20.2981 20.2981 16.5829 20.2981 12C20.2981 7.41711 16.5829 3.70186 12 3.70186ZM12 7.40186C12.4971 7.40186 12.9 7.80476 12.9 8.30186V12.6019C12.9 13.099 12.4971 13.5019 12 13.5019C11.5029 13.5019 11.1 13.099 11.1 12.6019V8.30186C11.1 7.80476 11.5029 7.40186 12 7.40186ZM12 17.1019C12.6627 17.1019 13.2 16.5646 13.2 15.9019C13.2 15.2392 12.6627 14.7019 12 14.7019C11.3373 14.7019 10.8 15.2392 10.8 15.9019C10.8 16.5646 11.3373 17.1019 12 17.1019Z" fill=""></path>
            </svg>
        </div>
        <div>
            <h4 class="mb-1 text-sm font-semibold text-gray-800 dark:text-white/90">
                Important Information
            </h4>
            <ul class="list-disc pl-5 text-sm text-gray-600 dark:text-gray-400 space-y-1">
                <li>Each combination of Teacher, Course, Batch, and Semester must be unique</li>
                <li>Only active teachers, courses, batches, and semesters are shown</li>
                <li>You can assign the same course to multiple teachers for different batches</li>
                <li>Inactive assignments won't be visible in the active course schedule</li>
            </ul>
        </div>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />

    <script>
        // Show validation summary if there are errors
        document.addEventListener('DOMContentLoaded', function () {
            const validationSummary = document.querySelector('[asp-validation-summary]');
            if (validationSummary && validationSummary.querySelector('li')) {
                validationSummary.classList.remove('hidden');
            }
        });
    </script>
}
